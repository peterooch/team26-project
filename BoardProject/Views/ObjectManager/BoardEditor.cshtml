@model Board
@inject Localizer locale
@{
    ViewData["Title"] = locale["Board Editor"];
}
<script src="~/js/draggable.js"></script>
<script>
    /* Some variables for boardeditor.js stuff */
    var padding = "@Model.Spacing.ToString()%";
</script>
<script src="~/js/boardeditor.js"></script>
<div class="input-group">
    <!-- General Board information such as namings and styling -->
    <div class="input-group-prepend">
        <span class="input-group-text">@locale["Board Name"]</span>
    </div>
    <input onchange="RefreshEditor();" type="text" id="board_name" class="form-control mr-2" value="@Model.BoardName" />
    <div class="input-group-prepend">
        <span class="input-group-text">@locale["Board Header"]</span>
    </div>
    <input onchange="RefreshEditor();" type="text" id="board_header" class="form-control mr-2" value="@Model.BoardHeader" />
    <div class="input-group-prepend">
        <span class="input-group-text">@locale["Background Color"]</span>
    </div>
    <input onchange="RefreshEditor();" type="text" id="bg_color" class="jscolor form-control mr-2" value="@Model.BackgroundColor.ToString("X6")" />
    <div class="input-group-prepend">
        <span class="input-group-text">@locale["Text Color"]</span>
    </div>
    <input onchange="RefreshEditor();" type="text" id="tx_color" class="jscolor form-control mr-2" value="@Model.TextColor.ToString("X6")" />
    <div class="input-group-prepend">
        <span class="input-group-text">@locale["Font Size"]</span>
    </div>
    <input onchange="RefreshEditor();" type="number" id="font_size" class="form-control" value="@Model.FontSize.ToString()" />
    <div class="input-group-append mr-2">
        <span class="input-group-text">%</span>
    </div>
    <div class="input-group-prepend">
        <span class="input-group-text">@locale["Spacing"]</span>
    </div>
    <input onchange="RefreshEditor();" type="number" id="spacing" class="form-control" value="@Model.Spacing.ToString()" />
    <div class="input-group-append">
        <span class="input-group-text">%</span>
    </div>
</div>
<div class="input-group" style="justify-content: center">
    <input type="hidden" id="board_id" value="@Model.ID" />
    <button type="button" class="btn btn-primary mr-2" onclick="SaveBoard();">@locale["Save Board"]</button>
    <button type="button" class="btn btn-secondary mr-2" onclick="window.location.href='/Home/';">@locale["Quit without making changes"]</button>
    <button type="button" class="btn btn-danger" onclick="RemoveBoard();">@locale["Remove Board"]</button>
</div>
<!-- Debug code start -->
<div class="input-group mb-3">
    <button type="button" class="btn btn-success" onclick="$('#tileModal').modal('show');">Open Tile Modal</button>
    <button type="button" class="btn btn-primary" onclick="$('#imageModal').modal('show');">Open Image Modal</button>
</div>
<!-- Debug code end -->
<div class="tile_container" style="color: #@Model.TextColor.ToString("x6"); background-color: #@Model.BackgroundColor.ToString("x6"); font-size: @Model.FontSize.ToString()%;">
    @foreach (Tile tile in Model.Tiles)
    {
        <div class="tile_outer_container" style="padding: @Model.Spacing.ToString()%;">
            <div class="tiles" id="@tile.ID" style="background-color: #@tile.BackgroundColor.ToString("X6")">
                <center>
                    @tile.TileText
                    <span style="background-color: white;">
                        <img src="~/images/edit.png" onclick="GetTileData('@tile.ID');" />
                        <img src="~/images/delete.png" onclick="RemoveTile('@tile.ID');" />
                    </span>
                </center>
                <img src="@tile.Source.Source" alt="@tile.Source.ImageName" style="width: 24vw; height:35vh" />
            </div>
        </div>
    }
    <div onclick="GetTileData('');" class="tile_outer_container" style="text-align: center; order: 99; padding: @Model.Spacing.ToString()%; width: 24vw; height:35vh;">
        @locale["Add Tile"]
    </div>
</div>
<!-- Modal Boxes for Tile and Image menus, shamelessly copied from bootstrap docs -->
<div class="modal" id="tileModal" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="TileModalBox" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="tileModalTitle"><!-- JavaScript selected title if new or current tile --></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="TileModal">
                <div class="form-group">
                    <label class="modal-body">Tile name:</label>
                    <input type="text" name="tilename">
                </div>
                <label class="modal-body">Background color:</label>
                <input type="text" name="bg_color" class="jscolor" value="@Model.BackgroundColor.ToString("X6")" /><br />
                <label class="modal-body">Tile action's:</label>
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="nothing-tab" data-toggle="tab" href="#nothing" role="tab" aria-controls="nothing" aria-selected="true">Nothing</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="gif-tab" data-toggle="tab" href="#gif" role="tab" aria-controls="gif" aria-selected="false">Gif</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="link-tab" data-toggle="tab" href="#link" role="tab" aria-controls="link" aria-selected="false">Link</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="anotherboard-tab" data-toggle="tab" href="#anotherboard" role="tab" aria-controls="anotherboard" aria-selected="false">Anotherboard</a>
                    </li>
                </ul>
                <div class="tab-content" id="myTabContent">
                    <div class="tab-pane fade" id="nothing" role="tabpanel" aria-labelledby="nothing-tab">Just a picture</div>
                    <div class="tab-pane fade" id="gif" role="tabpanel" aria-labelledby="gif-tab">
                        <label class="modal-body">Gif:</label>
                        <button>Gif</button>
                        <hr />
                    </div>
                    <div class="tab-pane fade" id="link" role="tabpanel" aria-labelledby="link-tab">
                        <label class="modal-body">Enter url:</label>
                        <input type="text" name="url">
                    </div>
                    <div class="tab-pane fade" id="anotherboard" role="tabpanel" aria-labelledby="anotherboard-tab">...</div>
                </div>
                <hr />
                <div class="tile_outer_container" style="text-align: center; order: 99; padding: @Model.Spacing.ToString() %; width: 15vw; height:26.25vh; border: solid black 3px;">
                    @locale["Tile Preview"]
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">@locale["Save Tile"]</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">@locale["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal" id="imageModal" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="ImageModalBox" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="imageModalTitle"><!-- JavaScript selected title if new or current image --></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="imageModal">
                <form>
                    <div>
                        <label class="modal-body">Category:</label>
                        <select>
                            <option value="nothing">Nothing</option>
                        </select>
                        <label class="modal-body">Existing images:</label>
                        <button>Exist</button>
                        <hr/>
                        <label class="modal-body">Upload a new image:</label>
                        <button>Open</button><br/>
                        <label class="modal-body">New image category:</label>
                        <select>
                            <option value="nothing">Nothing</option>
                        </select><br />
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">@locale["Save Image"]</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">@locale["Cancel"]</button>
            </div>
        </div>
    </div>
</div>
<script>
    const container = document.querySelector('.tile_container');

    const swappable = new Draggable.Swappable(container, {
        draggable: '.tiles',
    });

    swappable.on('swappable:start', () => console.log('swappable:start'));
    swappable.on('swappable:swapped', () => console.log('swappable:swapped'));
    swappable.on('swappable:stop', () => console.log('swappable:stop'));
</script>
